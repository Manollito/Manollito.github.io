---
title: "My Website"
---

**Estudiante:** Harlen Daniel Quirós Gómez

**Carnet:** 2022082503

**Estudiante:** Manuel de Jesús Calero Ríos

**Carnet:** 2022082503

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library (ggplot2)
library(dplyr)
library(readxl)
library(plotly)
library(tidyr)
library(lubridate)

covid <- read_excel("CasosCOVID.xlsx", sheet = "1_GENERAL")
covid_provincias <- read_excel("CasosCOVID.xlsx", sheet = "2_4 CANT_ACTIVOS")
covid2 <- read_excel("CasosCOVID.xlsx", sheet = "2_5 CANT_NUEVOS")
covid_provincias <- covid_provincias %>%
  pivot_longer(names_to='fecha',
               cols = starts_with("4")) %>%
  mutate(fecha = as.Date(as.numeric(fecha), origin = "1900-01-01" )) %>%
  group_by(provincia, fecha) %>%
  summarise(casos = sum(value)) %>%
  mutate(anio = year(fecha)) %>%
  filter( provincia != 'Otros')
```

```{r echo=FALSE}
covid_no_acumulado <- covid %>%
  mutate(
    anterior_dia_hombre = lag(hom_posi),
    anterior_dia_mujer = lag(muj_posi),
    muj_posi_no_acumulado = muj_posi - anterior_dia_mujer,
    homb_posi_no_acumulado = hom_posi - anterior_dia_hombre,    
  ) %>%
  select(FECHA, muj_posi, anterior_dia_mujer, muj_posi_no_acumulado, hom_posi, anterior_dia_hombre, homb_posi_no_acumulado, everything())
```

```{r}
ggplot(covid, aes(nue_posi)) + geom_histogram(binwidth=100)+ 
  labs(
    x = "Cantidad de casos de covid", 
    title = "Casos nuevos covid") +
  scale_x_continuous(breaks=seq( 0, max(covid$nue_posi), by=500) ) +
  theme_classic()
```

Hacer reseña que por dicha no hubo muchos días con muchos casos nuevos de covid, la mayoría de días hubo menos de 500 casos.

```{r}
ggplot(covid_no_acumulado, aes(muj_posi_no_acumulado)) + geom_histogram(binwidth=100)+ 
  labs(
    x = "Cantidad casos de covid: Mujeres", 
    title = "Casos nuevos de covid en mujeres") +
  scale_x_continuous(breaks=seq( 0, max(covid$nue_posi), by=500) ) +
  theme_classic()
```

```{r}
ggplot(covid_no_acumulado, aes(homb_posi_no_acumulado)) + geom_histogram(binwidth=100)+ 
  labs(
    x = "Cantidad casos de covid: Hombres", 
    title = "Casos nuevos de covid en hombres") +
  scale_x_continuous(breaks=seq( 0, max(covid$nue_posi), by=500) ) +
  theme_classic()
```

Hacer reseña entre las diferencias y que nunca hubo tantos hombres positivos como mujeres en un solo dia.

```{r}
covid_edad <- covid %>%
  mutate(
    ant_dia_adul = lag(adul_posi),
    ant_dia_am = lag(am_posi),
    ant_dia_menor = lag(menor_posi),
    `Adultos fallecidos` = adul_posi - ant_dia_adul,
    `Adultos mayores fallecidos`  = am_posi - ant_dia_am,
    `Menores fallecidos`  = menor_posi - ant_dia_menor
  ) %>%
  select(`Menores fallecidos`, `Adultos fallecidos`, `Adultos mayores fallecidos`, FECHA) %>%
  pivot_longer(names_to='edad',
               cols = c('Menores fallecidos',  'Adultos fallecidos',	'Adultos mayores fallecidos')
) %>%
  filter(!is.na(value))

```

```{r}
ggplot(covid_edad, aes(edad, value)) + geom_violin() + 
  labs(
    x = "Categoria de edad", 
    y = "Cantidad de casos", 
    title = "Cantidad de casos por categoría de edad"
  ) +
  scale_y_continuous(breaks=seq( 0, max(covid_edad$value), by=500) ) +
  theme_classic()
```

Hacer reseña hubieron muchos días con pocos casos en niños y adultos mayores, pero con los adultos tuvieron días con muchos más casos, estos fueron pocos días, por eso la gráfica se ve tan punteada.

```{r}
covid_muertos <- covid %>%
  mutate(
    ant_dia_hom_fall = lag(hom_fall),
    ant_dia_muj_fall = lag(muj_fall),
    `hombres fallecidos` = hom_fall - ant_dia_hom_fall,
    `mujeres fallecidas` = muj_fall - ant_dia_muj_fall
  ) %>%
  select(`hombres fallecidos`, `mujeres fallecidas`, FECHA) %>%
  pivot_longer(names_to='fallecidos',
               cols = c('hombres fallecidos',  'mujeres fallecidas')
) %>%
  filter(!is.na(value), value>=0)
```

```{r}
ggplot(covid_muertos, aes(fallecidos, value)) + geom_boxplot() + 
  labs(
    x = "Sexo de los fallecidos", 
    y = "Cantidad de fallecidos", 
    title = "Cantidad de fallecidos por sexo"
  ) +
  scale_y_continuous(breaks=seq( 0, max(covid_edad$value), by=500) ) +
  theme_classic()
```

En ambos gráficos se puede ver que hay días donde levemente hubo más hombres fallecidos que mujeres. Hubieron días que no hubo muertes. La caja de los hombres se observa un poco más larga, lo que quiere decir que la dispersión de cantidad de fallecidos por día es mayor en los hombres.

```{r}
ggplot(covid_provincias, aes(fecha, casos)) + 
  geom_line() + 
  facet_grid(provincia ~ anio, scales = "free_x")+
  theme_minimal()
```

Hacer reseña de que san josé tiene muchos picos en más años comparados con las otras provincias, de igual manera en Alajuela

```{r}

```
<<<<<<< Updated upstream

# Gráfica multidimensional

```{r}
covid_2021 <- covid2 %>%
  select(cod_provin, provincia, cod_canton, canton, starts_with("2021"))
head(covid2)
# Suma de casos totales por provincia
casos_totales_2021 <- rowSums(covid_2021[, -(1:4)])

# Crear un dataframe con las provincias y sus casos totales
datos_grafico_2021 <- data.frame(provincia = covid_2021$provincia, casos_totales = casos_totales_2021)

# Ordenar los datos de mayor a menor según los casos totales
datos_grafico_2021 <- datos_grafico_2021[order(-datos_grafico_2021$casos_totales), ]

# Crear el gráfico de barras
barplot(height = datos_grafico_2021$casos_totales,
        names.arg = datos_grafico_2021$provincia,
        las = 2,  # Orientación de etiquetas en el eje x
        main = "Casos totales de COVID por provincia en 2021",
        xlab = "Provincia",
        ylab = "Casos totales de COVID")
```
